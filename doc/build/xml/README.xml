<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.12 -->
<document source="/space/projects/slicepp/doc/source/README.rst">
    <comment xml:space="preserve">Multislice Simulation documentation master file, created by
sphinx-quickstart on Thu Aug 20 11:30:21 2015.
You can adapt this file completely to your liking, but it should at least
contain the root `toctree` directive.</comment>
    <section ids="welcome-to-slicepp-s-documentation" names="welcome\ to\ slicepp's\ documentation!">
        <title>Welcome to Slicepp's documentation!</title>
        <compound classes="toctree-wrapper">
            <compact_paragraph toctree="True"><bullet_list></bullet_list></compact_paragraph>
        </compound>
    </section>
    <section ids="about" names="about">
        <title>About</title>
        <paragraph>Slicepp is a multislice simulation software.It simulates an incoming electron wave striking and propagating through a user-defined sample, eventually picked up by a detector. This software is accelerated by the NVIDIA CUDA platform and ArrayFire.</paragraph>
    </section>
    <section ids="installation" names="installation">
        <title>Installation</title>
        <paragraph><strong>Libraries Required</strong></paragraph>
        <table>
            <tgroup cols="3">
                <colspec colwidth="61">
                </colspec>
                <colspec colwidth="17">
                </colspec>
                <colspec colwidth="16">
                </colspec>
                <thead>
                    <row>
                        <entry>
                            <paragraph>Library</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Version</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Comments</paragraph>
                        </entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry>
                            <paragraph><reference name="Armadillo" refuri="http://arma.sourceforge.net/">Armadillo</reference><target ids="armadillo" names="armadillo" refuri="http://arma.sourceforge.net/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 5.0</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="ArrayFire" refuri="http://www.arrayfire.com/">ArrayFire</reference><target ids="arrayfire" names="arrayfire" refuri="http://www.arrayfire.com/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 3.0</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="Boost" refuri="http://www.boost.org/">Boost</reference><target ids="boost" names="boost" refuri="http://www.boost.org/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 1.5</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="CUDA Toolkit" refuri="https://developer.nvidia.com/cuda-downloads">CUDA Toolkit</reference><target ids="cuda-toolkit" names="cuda\ toolkit" refuri="https://developer.nvidia.com/cuda-downloads"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 7.0</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="FFTW3" refuri="http://www.fftw.org/">FFTW3</reference><target ids="fftw3" names="fftw3" refuri="http://www.fftw.org/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 3.3</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="HDF5" refuri="https://www.hdfgroup.org/HDF5/">HDF5</reference><target ids="hdf5" names="hdf5" refuri="https://www.hdfgroup.org/HDF5/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 1.8</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="NLopt" refuri="http://ab-initio.mit.edu/wiki/index.php/NLopt">NLopt</reference><target ids="nlopt" names="nlopt" refuri="http://ab-initio.mit.edu/wiki/index.php/NLopt"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 2.4</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="OpenBabel" refuri="http://openbabel.org/wiki/Main_Page">OpenBabel</reference><target ids="openbabel" names="openbabel" refuri="http://openbabel.org/wiki/Main_Page"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 2.3</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="OpenMP" refuri="http://openmp.org/wp/">OpenMP</reference><target ids="openmp" names="openmp" refuri="http://openmp.org/wp/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>&gt;= 4.0</paragraph>
                        </entry>
                        <entry>
                            <paragraph>Required</paragraph>
                        </entry>
                    </row>
                    <row>
                        <entry>
                            <paragraph><reference name="Python2" refuri="https://www.python.org/">Python2</reference><target ids="python2" names="python2" refuri="https://www.python.org/"></target></paragraph>
                        </entry>
                        <entry>
                            <paragraph>2.7</paragraph>
                        </entry>
                        <entry>
                            <paragraph>GUI</paragraph>
                        </entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
        <paragraph><strong>Compilation</strong></paragraph>
        <paragraph><emphasis>Debug</emphasis></paragraph>
        <literal_block xml:space="preserve">% cd /slicepp/build/debug
% ./remake.sh
% make -j2</literal_block>
        <paragraph><emphasis>Release</emphasis></paragraph>
        <literal_block xml:space="preserve">% cd /slicepp/build/release
% ./remake.sh:</literal_block>
    </section>
    <section ids="execution" names="execution">
        <title>Execution</title>
        <paragraph><emphasis>From terminal</emphasis></paragraph>
        <paragraph>Run the following commands in terminal:</paragraph>
        <literal_block xml:space="preserve">% cd /slicepp/build/release/bin
%./stem3 [PATH_TO_CONFIG_FILE]</literal_block>
        <paragraph><emphasis>From GUI</emphasis></paragraph>
        <paragraph>Run the following commands in terminal:</paragraph>
        <literal_block xml:space="preserve">% cd /slicepp/GUI_new
% python window.py</literal_block>
    </section>
    <section ids="programming-guide" names="programming\ guide">
        <title>Programming Guide</title>
        <paragraph><strong>Source Code Structure</strong></paragraph>
        <paragraph>Source code for the main project are in the <strong>/libs</strong> folder. Families of hierarchial code are grouped into subdirectories (e.g. wavefunctions, potentials, detectors). In each of these subdirectories, there is a header file, usually called <strong>[DIRECTORYNAME]_interface.hpp</strong>, that serves as a template for other classes in the same directory.To create a new class, simply inherit from the template and override methods where appropriate. For instance, if one wants to create a new way of calculate potential, one can make a subclass of potential_interface called NewPotential. Then, implement pure virtual and other additional methods in the NewPotential class. When creating a new subdirectory of <strong>/libs</strong>, make sure also to create a CMakeList.txt to change the scopes of the files (examples can be found in existing subdirectories) and modify the CMakeLists in <strong>/libs</strong> to include the newly created subdirectory. Project scope classes should be added in the <strong>/libs</strong> folder.</paragraph>
        <paragraph>Important definitions (variables types, constants, precision) are in the file called <strong>stemtypes_fftw3.hpp</strong>, also in the <strong>/libs</strong> folder. New definitions should be appended to this file.</paragraph>
        <paragraph><strong>Parallelization with CUDA/ArrayFire</strong></paragraph>
        <paragraph>ArrayFire will be imported automatically when building the project with cmake.</paragraph>
        <paragraph>When creating CUDA source files (files with .cu extensions), make sure it stands alone and does not include any non-native C++ libraries. The NVCC compiler is known to have compilation issues with fftw3, Boost, etc. Additionally, modify the CMakeList.txt in the same directory to explicitly compile .cu files. An example of implementing raw CUDA files is <strong>CUDA2DPotential.cu</strong> in <strong>/libs/potentials</strong>. Using ArrayFire along side CUDA memory allocation (cudaMalloc()) and libraries (cuBLAS, cuFFT, etc.) sometimes produce wrong results or even memory violations. Therefore, implement CUDA kernels only when absolutely needed as most operations have equivalent ArrayFire counterparts.</paragraph>
        <paragraph><strong>Main Executable</strong></paragraph>
        <paragraph>The main <strong>stem3.cpp</strong> is in the <strong>/stem3</strong> folder. The <strong>Bootstrapper</strong> class handles creation of wavefunctions, potentials, etc. Append to the appropriate <strong>Register[TYPENAME]Types()</strong> functions when implementing new features.</paragraph>
        <paragraph><strong>New Config Parameters</strong></paragraph>
        <paragraph>To add new external parameters, modify appropriate sections of the <strong>read_qsc</strong> class in <strong>/libs/Config_IO</strong>.</paragraph>
    </section>
    <section ids="class" names="class">
        <title>Class</title>
        <warning>
            <paragraph>doxygenclass: Cannot find file: /space/projects/slicepp/doc/source/build/xml/README.xml/index.xml</paragraph>
        </warning>
    </section>
    <section ids="support" names="support">
        <title>Support</title>
    </section>
    <section ids="license" names="license">
        <title>License</title>
    </section>
</document>
